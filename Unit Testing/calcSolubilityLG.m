function [ m_CH4 ] = calcSolubilityLG( pressure , temperature , NaCl )
% Input is pressure (Pa), temperature (K), and NaCl (mol CH4/L H2O) at depth Z

x_CH4 = 1; % mole composition in the vapor phase

Tc = 190.6; % K
Tr = temperature ./ Tc;

Pc = 46.41; % bars
pressure = pressure .* 1e-5; % changes P from Pa to bars
Pr = pressure ./ Pc;

% Interaction parameters for dimensionless chemical potential (mu/RT) CH4
mu_c = [4.30310345E+1;  ...
        -6.83277221E-2; ...
        -5.68718730E+3; ...
        3.56636821E-5;  ...
        -5.79133791E+1; ...
        6.11616662E-3;  ...
        -7.85528103E-4; ...
        -9.42540759E-2; ...
        1.92132040E-2;  ...
        -9.17186899E-06];

% Interaction parameters for lambda CH4,Na
lambda_c = [9.92230792E-2;  ...
            2.57906811E-5;  ...
            0;              ...
            0;              ...
            0;              ...
            0;              ...
            0;              ...
            1.83451402E-2;  ...
            0;              ...
            -8.07196716E-6];

% Interaction parameters for xi CH4,Na,Cl
xi_c = [-6.23943799E-3; ...
        0;              ...
        0;              ...
        0;              ...
        0;              ...
        0;              ...
        0;              ...
        0;              ...
        0;              ...
        0];

[ mu_par ]      = calcPitzerParameter( mu_c , pressure , temperature );
[ lambda_par ]  = calcPitzerParameter( lambda_c , pressure , temperature );
[ xi_par ]      = calcPitzerParameter( xi_c , pressure , temperature );

[ Vr , B , C , D , E , G ] = calcVr(Pr,Tr);
Z = Pr*Vr/Tr;

fugacityCoefficient = exp( Z - 1 - log(Z) + B/Vr + C/(2*Vr^2) + D/(4*Vr^4) + E/(5*Vr^5) + G );

m_CH4 = x_CH4 .* pressure / exp( mu_par + 2 * lambda_par * NaCl + xi_par * NaCl^2 - log(fugacityCoefficient) );
    



